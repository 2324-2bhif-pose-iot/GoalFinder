var N=Object.defineProperty;var S=(d,e,r)=>e in d?N(d,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[e]=r;var n=(d,e,r)=>S(d,typeof e!="symbol"?e+"":e,r);import{_ as T,f as o,o as l,a as t,d as M,g as A,h as $,u as H,c as D,w as m,i as w,b as u,t as s,e as _,B as f,j as F,k as E,F as b,l as C}from"./index.js";import{P as L}from"./Page.js";import{I as U}from"./InputForm.js";/* empty css                                                    */class z{constructor(){n(this,"_players");n(this,"_isRunning",!1);this._players=[]}get isRunning(){return this._isRunning}get players(){return[...this._players]}get sortedPlayers(){return this._players.slice().sort((e,r)=>{const c=e.hits-e.misses;return r.hits-r.misses-c})}addPlayer(e){this._players.some(r=>r.name===e.name)||this._players.push(e)}removePlayer(e){this._players.splice(e,1)}addHitToPlayer(e){this._players[e].addHit()}addMissToPlayer(e){this._players[e].addMiss()}start(){this._isRunning=!0}pause(){this._isRunning=!1}}const P=class P extends z{constructor(){super();n(this,"_timer",0);n(this,"timerIntervalId",-1);n(this,"selectedPlayerIndex",0);this.resetTimer()}get timer(){return this._timer}getSelectedPlayer(){return this.players[this.selectedPlayerIndex]}removePlayer(r){super.removePlayer(r),this.reset()}start(){this.isRunning||(this.timerIntervalId=setInterval(async()=>{this._timer--;try{const r=await fetch("/api/hits",{method:"GET"}),c=parseInt(await r.text());for(let y=0;y<c;y++)this.getSelectedPlayer().addHit();const g=await fetch("/api/hits",{method:"GET"}),v=parseInt(await g.text());for(let y=0;y<v;y++)this.getSelectedPlayer().addMiss()}catch(r){console.log(r)}this._timer<=0&&(this.resetTimer(),this.selectNewPlayer())},1e3)),super.start()}pause(){clearInterval(this.timerIntervalId),super.pause()}reset(){this.selectedPlayerIndex=0,this.pause(),this.resetTimer()}selectNewPlayer(){this.selectedPlayerIndex++,this.selectedPlayerIndex>=this.players.length&&(this.selectedPlayerIndex=0)}resetTimer(){this._timer=P.PLAY_DURATION}};n(P,"PLAY_DURATION",60);let k=P;class G{constructor(e){n(this,"_name");n(this,"_hits",0);n(this,"_misses",0);this._name=e}get name(){return this._name}get hits(){return this._hits}get misses(){return this._misses}addHit(){this._hits++}addMiss(){this._misses++}}const O={},Y={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-play",viewBox:"0 0 16 16"};function j(d,e){return l(),o("svg",Y,e[0]||(e[0]=[t("path",{d:"M10.804 8 5 4.633v6.734zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696z"},null,-1)]))}const q=T(O,[["render",j]]),x={key:0,class:"basketball-shot-tracker"},J={for:"player-name-input"},K={class:"buttons-container"},Q={key:0,id:"current-player-container"},W={key:1},X={id:"player-list"},Z={class:"buttons-container"},ee={key:2},te={key:1,class:"leaderboard"},se=M({__name:"ShotChallengeView",setup(d){const e=A(new k),r=$(!1),c=$(""),g=H("add-player-form");function v(a,h){h?e.addHitToPlayer(a):e.addMissToPlayer(a)}function y(){r.value=!0}function V(){r.value=!1,e.reset()}function R(){e.addPlayer(new G(c.value)),g.value.reset()}function B(){e.isRunning?e.pause():e.start()}return(a,h)=>(l(),D(L,{title:a.$t("header.game_shot_challenge")},{default:m(()=>[r.value?(l(),o("div",te,[t("h2",null,s(a.$t("word.leaderboard")),1),t("ul",null,[(l(!0),o(b,null,C(e.sortedPlayers,(i,p)=>(l(),o("li",{key:p},[t("strong",null,s(p+1)+". "+s(i.name),1),_(" - "+s(a.$t("word.hits"))+": "+s(i.hits)+", "+s(a.$t("word.misses"))+": "+s(i.misses),1)]))),128))]),u(f,{primary:"",onClick:V},{default:m(()=>[_(s(a.$t("word.restart")),1)]),_:1})])):(l(),o("div",x,[t("form",{ref:"add-player-form",onSubmit:E(R,["prevent"])},[t("div",null,[t("label",J,s(a.$t("word.add_person")),1),u(U,{id:"player-name-input",modelValue:c.value,"onUpdate:modelValue":h[0]||(h[0]=i=>c.value=i)},null,8,["modelValue"])]),t("div",K,[u(f,{type:"submit"},{default:m(()=>[_(s(a.$t("word.add_person")),1)]),_:1}),u(F,{readonly:"",id:"game-state-button",modelValue:e.isRunning,"onUpdate:modelValue":h[1]||(h[1]=i=>e.isRunning=i),onClick:B},{default:m(()=>[u(q,{id:"play-icon"})]),_:1},8,["modelValue"])])],544),e.players.length?(l(),o("div",Q,[t("h1",null,s(e.timer),1),t("h1",null,s(e.getSelectedPlayer().name),1)])):w("",!0),e.players.length?(l(),o("div",W,[t("h3",null,s(a.$t("word.person_list")),1),t("table",X,[h[2]||(h[2]=t("thead",null,[t("tr",null,[t("th",null,"Player"),t("th",null,"Hits"),t("th",null,"Misses"),t("th",null,"Edit")])],-1)),t("tbody",null,[(l(!0),o(b,null,C(e.players,(i,p)=>(l(),o("tr",{key:p},[t("td",null,s(i.name),1),t("td",null,s(i.hits),1),t("td",null,s(i.misses),1),t("td",null,[t("div",Z,[u(f,{primary:"",onClick:I=>v(p,!0)},{default:m(()=>[_(s(a.$t("word.hit")),1)]),_:2},1032,["onClick"]),u(f,{onClick:I=>v(p,!1),severity:"warning"},{default:m(()=>[_(s(a.$t("word.miss")),1)]),_:2},1032,["onClick"]),u(f,{onClick:I=>e.removePlayer(p),severity:"danger"},{default:m(()=>[_(s(a.$t("word.remove")),1)]),_:2},1032,["onClick"])])])]))),128))])])])):w("",!0),e.players.length?(l(),o("div",ee,[u(f,{primary:"",onClick:y},{default:m(()=>[_(s(a.$t("word.finish")),1)]),_:1})])):w("",!0)]))]),_:1},8,["title"]))}}),oe=T(se,[["__scopeId","data-v-ecac0d8a"]]);export{oe as default};
