var S=Object.defineProperty;var M=(d,e,r)=>e in d?S(d,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[e]=r;var n=(d,e,r)=>M(d,typeof e!="symbol"?e+"":e,r);import{_ as R,f as o,o as l,a as t,d as A,g as H,h as $,u as D,c as F,w as m,i as w,b as u,t as s,e as _,B as f,j as L,k as U,F as b,l as C}from"./index.js";import{P as E}from"./Page.js";import{I as z}from"./InputForm.js";/* empty css                                                    */const T="/api";class G{constructor(){n(this,"_players");n(this,"_isRunning",!1);this._players=[]}get isRunning(){return this._isRunning}get players(){return[...this._players]}get sortedPlayers(){return this._players.slice().sort((e,r)=>{const c=e.hits-e.misses;return r.hits-r.misses-c})}addPlayer(e){this._players.some(r=>r.name===e.name)||this._players.push(e)}removePlayer(e){this._players.splice(e,1)}addHitToPlayer(e){this._players[e].addHit()}addMissToPlayer(e){this._players[e].addMiss()}start(){this._isRunning=!0}pause(){this._isRunning=!1}}const P=class P extends G{constructor(){super();n(this,"_timer",0);n(this,"timerIntervalId",-1);n(this,"selectedPlayerIndex",0);this.resetTimer()}get timer(){return this._timer}getSelectedPlayer(){return this.players[this.selectedPlayerIndex]}removePlayer(r){super.removePlayer(r),this.reset()}start(){this.isRunning||(this.timerIntervalId=setInterval(async()=>{this._timer--;try{const r=await fetch(`${T}/hits`,{method:"GET"}),c=parseInt(await r.text());for(let y=0;y<c;y++)this.getSelectedPlayer().addHit();const g=await fetch(`${T}/misses`,{method:"GET"}),v=parseInt(await g.text());for(let y=0;y<v;y++)this.getSelectedPlayer().addMiss()}catch(r){console.log(r)}this._timer<=0&&(this.resetTimer(),this.selectNewPlayer())},1e3)),super.start()}pause(){clearInterval(this.timerIntervalId),super.pause()}reset(){this.selectedPlayerIndex=0,this.pause(),this.resetTimer()}selectNewPlayer(){this.selectedPlayerIndex++,this.selectedPlayerIndex>=this.players.length&&(this.selectedPlayerIndex=0)}resetTimer(){this._timer=P.PLAY_DURATION}};n(P,"PLAY_DURATION",60);let k=P;class O{constructor(e){n(this,"_name");n(this,"_hits",0);n(this,"_misses",0);this._name=e}get name(){return this._name}get hits(){return this._hits}get misses(){return this._misses}addHit(){this._hits++}addMiss(){this._misses++}}const Y={},j={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-play",viewBox:"0 0 16 16"};function q(d,e){return l(),o("svg",j,e[0]||(e[0]=[t("path",{d:"M10.804 8 5 4.633v6.734zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696z"},null,-1)]))}const x=R(Y,[["render",q]]),J={key:0,class:"basketball-shot-tracker"},K={for:"player-name-input"},Q={class:"buttons-container"},W={key:0,id:"current-player-container"},X={key:1},Z={id:"player-list"},ee={class:"buttons-container"},te={key:2},se={key:1,class:"leaderboard"},re=A({__name:"ShotChallengeView",setup(d){const e=H(new k),r=$(!1),c=$(""),g=D("add-player-form");function v(a,h){h?e.addHitToPlayer(a):e.addMissToPlayer(a)}function y(){r.value=!0}function V(){r.value=!1,e.reset()}function B(){e.addPlayer(new O(c.value)),g.value.reset()}function N(){e.isRunning?e.pause():e.start()}return(a,h)=>(l(),F(E,{title:a.$t("header.game_shot_challenge")},{default:m(()=>[r.value?(l(),o("div",se,[t("h2",null,s(a.$t("word.leaderboard")),1),t("ul",null,[(l(!0),o(b,null,C(e.sortedPlayers,(i,p)=>(l(),o("li",{key:p},[t("strong",null,s(p+1)+". "+s(i.name),1),_(" - "+s(a.$t("word.hits"))+": "+s(i.hits)+", "+s(a.$t("word.misses"))+": "+s(i.misses),1)]))),128))]),u(f,{primary:"",onClick:V},{default:m(()=>[_(s(a.$t("word.restart")),1)]),_:1})])):(l(),o("div",J,[t("form",{ref:"add-player-form",onSubmit:U(B,["prevent"])},[t("div",null,[t("label",K,s(a.$t("word.add_person")),1),u(z,{id:"player-name-input",modelValue:c.value,"onUpdate:modelValue":h[0]||(h[0]=i=>c.value=i)},null,8,["modelValue"])]),t("div",Q,[u(f,{type:"submit"},{default:m(()=>[_(s(a.$t("word.add_person")),1)]),_:1}),u(L,{readonly:"",id:"game-state-button",modelValue:e.isRunning,"onUpdate:modelValue":h[1]||(h[1]=i=>e.isRunning=i),onClick:N},{default:m(()=>[u(x,{id:"play-icon"})]),_:1},8,["modelValue"])])],544),e.players.length?(l(),o("div",W,[t("h1",null,s(e.timer),1),t("h1",null,s(e.getSelectedPlayer().name),1)])):w("",!0),e.players.length?(l(),o("div",X,[t("h3",null,s(a.$t("word.person_list")),1),t("table",Z,[h[2]||(h[2]=t("thead",null,[t("tr",null,[t("th",null,"Player"),t("th",null,"Hits"),t("th",null,"Misses"),t("th",null,"Edit")])],-1)),t("tbody",null,[(l(!0),o(b,null,C(e.players,(i,p)=>(l(),o("tr",{key:p},[t("td",null,s(i.name),1),t("td",null,s(i.hits),1),t("td",null,s(i.misses),1),t("td",null,[t("div",ee,[u(f,{primary:"",onClick:I=>v(p,!0)},{default:m(()=>[_(s(a.$t("word.hit")),1)]),_:2},1032,["onClick"]),u(f,{onClick:I=>v(p,!1),severity:"warning"},{default:m(()=>[_(s(a.$t("word.miss")),1)]),_:2},1032,["onClick"]),u(f,{onClick:I=>e.removePlayer(p),severity:"danger"},{default:m(()=>[_(s(a.$t("word.remove")),1)]),_:2},1032,["onClick"])])])]))),128))])])])):w("",!0),e.players.length?(l(),o("div",te,[u(f,{primary:"",onClick:y},{default:m(()=>[_(s(a.$t("word.finish")),1)]),_:1})])):w("",!0)]))]),_:1},8,["title"]))}}),de=R(re,[["__scopeId","data-v-ecac0d8a"]]);export{de as default};
