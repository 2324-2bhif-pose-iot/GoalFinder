var N=Object.defineProperty;var H=(d,e,r)=>e in d?N(d,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):d[e]=r;var n=(d,e,r)=>H(d,typeof e!="symbol"?e+"":e,r);import{_ as C,f as o,o as l,a as t,d as M,g as A,h as I,u as F,i as L,c as U,w as c,j as g,b as u,t as s,e as p,B as _,k as D,l as E,F as $,m as b}from"./index.js";import{P as z}from"./Page.js";import{I as O}from"./InputForm.js";/* empty css                                                    */const Y="/api";class j{constructor(){n(this,"_players");n(this,"_isRunning",!1);this._players=[]}get isRunning(){return this._isRunning}get players(){return[...this._players]}get sortedPlayers(){return this._players.slice().sort((e,r)=>{const h=e.hits-e.misses;return r.hits-r.misses-h})}addPlayer(e){this._players.some(r=>r.name===e.name)||this._players.push(e)}removePlayer(e){this._players.splice(e,1)}addHitToPlayer(e){this._players[e].addHit()}addMissToPlayer(e){this._players[e].addMiss()}start(){this._isRunning=!0}pause(){this._isRunning=!1}}const f=class f extends j{constructor(){super();n(this,"_timer",0);n(this,"timerIntervalId",-1);n(this,"selectedPlayerIndex",0);this.resetTimer()}get timer(){return this._timer}getSelectedPlayer(){return this.players[this.selectedPlayerIndex]}removePlayer(r){super.removePlayer(r),this.reset()}async start(){this.isRunning||(this.timerIntervalId=setInterval(async()=>{this._timer--;const r=await fetch(`${Y}/hits`,{method:"GET"}),h=parseInt(await r.text());console.log(h),h>0&&(this.getSelectedPlayer().addHit(),this.resetTimer(),this.selectNewPlayer()),this._timer<=0&&(this.getSelectedPlayer().addMiss(),this.resetTimer(),this.selectNewPlayer())},1e3)),super.start()}pause(){clearInterval(this.timerIntervalId),super.pause()}reset(){this.selectedPlayerIndex=0,this.pause(),this.resetTimer()}selectNewPlayer(){this.selectedPlayerIndex++,this.selectedPlayerIndex>=this.players.length&&(this.selectedPlayerIndex=0)}resetTimer(){this._timer=f.PLAY_DURATION}};n(f,"PLAY_DURATION",60);let v=f;class G{constructor(e){n(this,"_name");n(this,"_hits",0);n(this,"_misses",0);this._name=e}get name(){return this._name}get hits(){return this._hits}get misses(){return this._misses}addHit(){this._hits++}addMiss(){this._misses++}}const q={},J={xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"bi bi-play",viewBox:"0 0 16 16"};function K(d,e){return l(),o("svg",J,e[0]||(e[0]=[t("path",{d:"M10.804 8 5 4.633v6.734zm.792-.696a.802.802 0 0 1 0 1.392l-6.363 3.692C4.713 12.69 4 12.345 4 11.692V4.308c0-.653.713-.998 1.233-.696z"},null,-1)]))}const Q=C(q,[["render",K]]),W={key:0,class:"basketball-shot-tracker"},X={for:"player-name-input"},Z={class:"buttons-container"},x={key:0,id:"current-player-container"},ee={key:1},te={id:"player-list"},se={class:"buttons-container"},re={key:2},ae={key:1,class:"leaderboard"},ie=M({__name:"ShotChallengeView",setup(d){const e=A(new v),r=I(!1),h=I(""),P=F(),T=L("add-player-form");function w(a,m){m?e.addHitToPlayer(a):e.addMissToPlayer(a)}function R(){r.value=!0}function V(){r.value=!1,e.reset()}function S(){e.addPlayer(new G(h.value)),T.value.reset()}function B(){e.isRunning?(e.pause(),P.isSoundEnabled=!1):e.start()}return(a,m)=>(l(),U(z,{title:a.$t("header.game_shot_challenge")},{default:c(()=>[r.value?(l(),o("div",ae,[t("h2",null,s(a.$t("word.leaderboard")),1),t("ul",null,[(l(!0),o($,null,b(e.sortedPlayers,(i,y)=>(l(),o("li",{key:y},[t("strong",null,s(y+1)+". "+s(i.name),1),p(" - "+s(a.$t("word.hits"))+": "+s(i.hits)+", "+s(a.$t("word.misses"))+": "+s(i.misses),1)]))),128))]),u(_,{primary:"",onClick:V},{default:c(()=>[p(s(a.$t("word.restart")),1)]),_:1})])):(l(),o("div",W,[t("form",{ref:"add-player-form",onSubmit:E(S,["prevent"])},[t("div",null,[t("label",X,s(a.$t("word.add_person")),1),u(O,{id:"player-name-input",modelValue:h.value,"onUpdate:modelValue":m[0]||(m[0]=i=>h.value=i)},null,8,["modelValue"])]),t("div",Z,[u(_,{type:"submit"},{default:c(()=>[p(s(a.$t("word.add_person")),1)]),_:1}),u(D,{readonly:"",id:"game-state-button",modelValue:e.isRunning,"onUpdate:modelValue":m[1]||(m[1]=i=>e.isRunning=i),onClick:B},{default:c(()=>[u(Q,{id:"play-icon"})]),_:1},8,["modelValue"])])],544),e.players.length?(l(),o("div",x,[t("h1",null,s(e.timer),1),t("h1",null,s(e.getSelectedPlayer().name),1)])):g("",!0),e.players.length?(l(),o("div",ee,[t("h3",null,s(a.$t("word.person_list")),1),t("table",te,[m[2]||(m[2]=t("thead",null,[t("tr",null,[t("th",null,"Player"),t("th",null,"Hits"),t("th",null,"Misses"),t("th",null,"Edit")])],-1)),t("tbody",null,[(l(!0),o($,null,b(e.players,(i,y)=>(l(),o("tr",{key:y},[t("td",null,s(i.name),1),t("td",null,s(i.hits),1),t("td",null,s(i.misses),1),t("td",null,[t("div",se,[u(_,{primary:"",onClick:k=>w(y,!0)},{default:c(()=>[p(s(a.$t("word.hit")),1)]),_:2},1032,["onClick"]),u(_,{onClick:k=>w(y,!1),severity:"warning"},{default:c(()=>[p(s(a.$t("word.miss")),1)]),_:2},1032,["onClick"]),u(_,{onClick:k=>e.removePlayer(y),severity:"danger"},{default:c(()=>[p(s(a.$t("word.remove")),1)]),_:2},1032,["onClick"])])])]))),128))])])])):g("",!0),e.players.length?(l(),o("div",re,[u(_,{primary:"",onClick:R},{default:c(()=>[p(s(a.$t("word.finish")),1)]),_:1})])):g("",!0)]))]),_:1},8,["title"]))}}),he=C(ie,[["__scopeId","data-v-f38d232c"]]);export{he as default};
